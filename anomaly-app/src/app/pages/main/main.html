
<div class="dashboard-header">
    <h1>Live Anomaly Detection Dashboard</h1>
</div>

<div class="example-container">
    <span class="list-content">
                <div class="search">
                    <mat-form-field class="example-form-field">
                        <mat-label>Search for an Anomaly</mat-label>
                        <input matInput type="text" [(ngModel)]="value" (input)="onSearchChange()">
                        @if (value) {
                          <span class="clear-button" matSuffix mat-icon-button aria-label="Clear" (click)="clearSearch()">
                           clear
                          </span>
                        }
                    </mat-form-field>
                    <span class="material-symbols-outlined add-button">add_circle</span>
                </div>
         <div class="list-container">
             <div class="list-item" 
                  *ngFor="let item of filteredData" 
                  [class.active]="isItemSelected(item.id)"
                  (click)="selectItem(item.id)">
                 <div class="list-item-content">
                     <span class="list-item-name">{{ item.name }}</span>
                     <div class="mini-chart">
                         <canvas [id]="'miniChart' + item.id" width="80" height="40"></canvas>
                     </div>
                     <div class="list-item-numbers">
                         <span class="first-number">{{ item.firstNumber | number }}</span>
                         <span class="second-number">{{ item.secondNumber }}%</span>
                     </div>
                 </div>
             </div>
             
             <div class="no-results" *ngIf="filteredData.length === 0 && value">
                 <div class="no-results-content">
                     <span class="no-results-icon">üîç</span>
                     <span class="no-results-text">No features found matching "{{ value }}"</span>
                 </div>
             </div>
         </div>
    </span>
    <span class="chart-content">
        <div class="chart-filters">
            <div class="frequency-filter">
                <label for="frequency-select">Frequency:</label>
                <select id="frequency-select" [(ngModel)]="selectedFrequency" (change)="onFrequencyChange()">
                    <option value="daily">Daily</option>
                    <option value="weekly">Weekly</option>
                    <option value="monthly">Monthly</option>
                </select>
            </div>
            <div class="time-period-buttons">
                <button class="period-btn" [class.active]="selectedPeriod === '30D'" (click)="selectPeriod('30D')">30D</button>
                <button class="period-btn" [class.active]="selectedPeriod === '3M'" (click)="selectPeriod('3M')">3M</button>
                <button class="period-btn" [class.active]="selectedPeriod === '6M'" (click)="selectPeriod('6M')">6M</button>
                <button class="period-btn" [class.active]="selectedPeriod === 'max'" (click)="selectPeriod('max')">max</button>
            </div>
        </div>
        <div class="chart-container">
            <canvas #chartCanvas></canvas>
        </div>
    </span>
</div>

<app-anomaly-details 
    [isVisible]="showAnomalyDetails" 
    [anomalyData]="selectedAnomalyData"
    [analyzedPeriod]="analyzedPeriodData"
    [newsData]="newsData"
    [isLoadingNews]="isLoadingNews"
    (close)="onCloseAnomalyDetails()">
</app-anomaly-details>